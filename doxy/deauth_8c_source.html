<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProxyAuth: src/deauth.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProxyAuth
   </div>
   <div id="projectbrief">Linux PAM to authenticate device via Bluetooth device</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">deauth.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="deauth_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;bluetooth/bluetooth.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;bluetooth/rfcomm.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;bluetooth/sdp.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;bluetooth/sdp_lib.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;sys/select.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pam__misc_8h.html">pam_misc.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pam__bt__misc_8h.html">pam_bt_misc.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pam__bt__pair_8h.html">pam_bt_pair.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pam__bt__trust_8h.html">pam_bt_trust.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="proxy__dbus_8h.html">proxy_dbus.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="deauth_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">   26</a></span>&#160;<span class="preprocessor">#define SERVICE_NAME &quot;Proxy Auth&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="deauth_8c.html#a302042408ed9bc8cafe612e5352f3646">   27</a></span>&#160;<span class="preprocessor">#define SERVICE_DESC &quot;Continuous Authentication via Bluetooth&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="deauth_8c.html#a24ba7041aeadc36e8ebc312f087b7e5a">   28</a></span>&#160;<span class="preprocessor">#define SERVICE_PROV &quot;ProxyAuth&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="deauth_8c.html#a7c3ba1c119b90f8c6cc5231b3f95c726">   29</a></span>&#160;<span class="preprocessor">#define minThroughput 100  </span><span class="comment">//Min Throughput varies depending on devices and work scenarios. Calibrate as needed. </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="deauth_8c.html#a0f347b60daa600951edcb110491a98bb">   38</a></span>&#160;sdp_session_t *<a class="code" href="deauth_8c.html#a0f347b60daa600951edcb110491a98bb">sdp_connect</a>( <span class="keyword">const</span> bdaddr_t *src, <span class="keyword">const</span> bdaddr_t *dst, uint32_t flags );</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="deauth_8c.html#a822797738ca4ed6abfc03035c50bd356">   40</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#a822797738ca4ed6abfc03035c50bd356">sdp_close</a>( sdp_session_t *session );</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="deauth_8c.html#ab60d5a453b8ddc3dabc609fda5b03da2">   42</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#ab60d5a453b8ddc3dabc609fda5b03da2">sdp_record_register</a>(sdp_session_t *sess, sdp_record_t *rec, uint8_t flags);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="deauth_8c.html#a3000869e3fe498f41505e97cccdbd904">   44</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#a3000869e3fe498f41505e97cccdbd904">terminate_server</a>(<span class="keywordtype">int</span> server, <span class="keywordtype">int</span> client, sdp_session_t *session) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (client) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        close(client);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (server) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        close(server);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (session) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="deauth_8c.html#a822797738ca4ed6abfc03035c50bd356">sdp_close</a>(session);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="deauth_8c.html#ad44ae7f0926e25e6497a022253b7982a">   65</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#ad44ae7f0926e25e6497a022253b7982a">set_service</a>(uuid_t *svc_uuid, uuid_t *svc_class_uuid, sdp_list_t **svc_class_list, sdp_record_t *record, uint32_t *svc_uuid_int) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">/* set the general service ID */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//set svc_uuid (service uuid) by creating an unreserved 128-bit UUID from svc_uuid_int (a list of 4 32-bit uuid).</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">//sdp_uuid128_create is similar to str2ba function which converts the uint32_t uuid (rather than a string) to uuid_t type</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    sdp_uuid128_create(svc_uuid, svc_uuid_int);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    sdp_set_service_id(record, *svc_uuid);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">char</span> str[256] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    sdp_uuid2strn(svc_uuid, str, 256);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    printf(<span class="stringliteral">&quot;Registering UUID %s\n&quot;</span>, str);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// set the service class</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    sdp_uuid16_create(svc_class_uuid, SERIAL_PORT_SVCLASS_ID); <span class="comment">//create a Service Class ID</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    *svc_class_list = sdp_list_append(0, svc_class_uuid);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    sdp_set_service_classes(record, *svc_class_list);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="deauth_8c.html#a614303fa465a6ead9d2192eb5b4f7860">   86</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#a614303fa465a6ead9d2192eb5b4f7860">set_bluetooth_service_info</a>(sdp_profile_desc_t *profile, sdp_list_t **profile_list, sdp_record_t *record) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// set the Bluetooth profile information</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    sdp_uuid16_create(&amp;(profile-&gt;uuid), SERIAL_PORT_PROFILE_ID); <span class="comment">//create a Profile ID</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    profile-&gt;version = 0x0100;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    *profile_list = sdp_list_append(0, profile);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    sdp_set_profile_descs(record, *profile_list);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="deauth_8c.html#a44fd87ff5d7e23f995e2af34b13f22e8">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#a44fd87ff5d7e23f995e2af34b13f22e8">set_browsable</a>(sdp_list_t **root_list, sdp_record_t *record, uuid_t *root_uuid) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    sdp_uuid16_create(root_uuid, PUBLIC_BROWSE_GROUP);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    *root_list = sdp_list_append(0, root_uuid);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    sdp_set_browse_groups(record, *root_list);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="deauth_8c.html#a100a7b8b4efd0ca70223a63e5cc92857">  106</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#a100a7b8b4efd0ca70223a63e5cc92857">set_l2cap_info</a>(sdp_list_t **l2cap_list, sdp_list_t **proto_list, uuid_t *l2cap_uuid) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    sdp_uuid16_create(l2cap_uuid, L2CAP_UUID); </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    *l2cap_list = sdp_list_append(0, l2cap_uuid);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    *proto_list = sdp_list_append(0, *l2cap_list);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="deauth_8c.html#af5b58ce1d118346d8a948132b950e279">  115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#af5b58ce1d118346d8a948132b950e279">register_rfcomm_sock</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    sdp_data_t **channel, </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    sdp_record_t *record, </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    sdp_list_t **rfcomm_list, </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    sdp_list_t **proto_list, </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    sdp_list_t **access_proto_list,</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    uuid_t *rfcomm_uuid, </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    uint8_t *rfcomm_channel</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    ) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// register the RFCOMM channel for RFCOMM sockets</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    sdp_uuid16_create(rfcomm_uuid, RFCOMM_UUID);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    *channel = sdp_data_alloc(SDP_UINT8, rfcomm_channel);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    *rfcomm_list = sdp_list_append(0, rfcomm_uuid);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sdp_list_append(*rfcomm_list, *channel);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    sdp_list_append(*proto_list, *rfcomm_list);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    *access_proto_list = sdp_list_append(0, *proto_list);    </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    sdp_set_access_protos(record, *access_proto_list);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="deauth_8c.html#adffaffff2cd1eea35d6ccd6a91976c5b">  135</a></span>&#160;sdp_session_t *<a class="code" href="deauth_8c.html#adffaffff2cd1eea35d6ccd6a91976c5b">register_service</a>(uint8_t rfcomm_channel) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">/* A 128-bit number used to identify this service. The words are ordered from most to least</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    * significant, but within each word, the octets are ordered from least to most significant.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    * For example, the UUID represneted by this array is 00001101-0000-1000-8000-00805F9B34FB. (The</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    * hyphenation is a convention specified by the Service Discovery Protocol of the Bluetooth Core</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">    * Specification, but is not particularly important for this program.)</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">    * This UUID is the Bluetooth Base UUID and is commonly used for simple Bluetooth applications.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">    * Regardless of the UUID used, it must match the one that the Armatus Android app is searching</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">    * for.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">    *</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">    * NOTE: RFCOMM uses L2CAP as a transport</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">    * </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">//maintain a list of four 32-bit uuid which will be used to form a 128-bit uuid for setting a uuid to our service</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    uint32_t svc_uuid_int[] = { 0x01110000, 0x00100000, 0x80000080, 0xFB349B5F };</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    uuid_t root_uuid; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    uuid_t l2cap_uuid; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    uuid_t rfcomm_uuid;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    uuid_t svc_uuid;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    uuid_t svc_class_uuid;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">//NOTE: sdp_list_t is a linkedlist which needs to be free using sdp_list_free after use</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    sdp_list_t *l2cap_list = 0,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                *rfcomm_list = 0,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                *root_list = 0,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                *proto_list = 0,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                *access_proto_list = 0,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                *svc_class_list = 0,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                 *profile_list = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    sdp_data_t *channel = 0; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    sdp_profile_desc_t profile;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    sdp_record_t *record = sdp_record_alloc();<span class="comment">//{ 0 };</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    sdp_session_t *session = 0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *service_name = <a class="code" href="deauth_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *svc_dsc = <a class="code" href="deauth_8c.html#a302042408ed9bc8cafe612e5352f3646">SERVICE_DESC</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *service_prov = <a class="code" href="deauth_8c.html#a24ba7041aeadc36e8ebc312f087b7e5a">SERVICE_PROV</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="deauth_8c.html#ad44ae7f0926e25e6497a022253b7982a">set_service</a>(&amp;svc_uuid, &amp;svc_class_uuid, &amp;svc_class_list, record, svc_uuid_int);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="deauth_8c.html#a614303fa465a6ead9d2192eb5b4f7860">set_bluetooth_service_info</a>(&amp;profile, &amp;profile_list, record);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="deauth_8c.html#a44fd87ff5d7e23f995e2af34b13f22e8">set_browsable</a>(&amp;root_list, record, &amp;root_uuid);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="deauth_8c.html#a100a7b8b4efd0ca70223a63e5cc92857">set_l2cap_info</a>(&amp;l2cap_list, &amp;proto_list, &amp;l2cap_uuid);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="deauth_8c.html#af5b58ce1d118346d8a948132b950e279">register_rfcomm_sock</a>(&amp;channel, record, &amp;rfcomm_list, &amp;proto_list, &amp;access_proto_list, &amp;rfcomm_uuid, &amp;rfcomm_channel);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// set the name, provider, and description</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    sdp_set_info_attr(record, service_name, service_prov, svc_dsc);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// connect to the local SDP server, register the service record, and disconnect</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">    * NOTE: Server needs to advertise the Bluetooth Server, so we will use IPC method to tell sdpd</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">    *   (Bluez implementation of SDP server which is a daemon) what to advertise. This is done through</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">    *   the pipe `/var/run/sdp`</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    session = <a class="code" href="deauth_8c.html#a0f347b60daa600951edcb110491a98bb">sdp_connect</a>(BDADDR_ANY, BDADDR_LOCAL, SDP_RETRY_IF_BUSY);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="deauth_8c.html#ab60d5a453b8ddc3dabc609fda5b03da2">sdp_record_register</a>(session, record, 0);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// cleanup</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    sdp_data_free(channel);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    sdp_list_free(l2cap_list, 0);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    sdp_list_free(rfcomm_list, 0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    sdp_list_free(root_list, 0);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    sdp_list_free(proto_list, 0);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    sdp_list_free(access_proto_list, 0);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    sdp_list_free(svc_class_list, 0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    sdp_list_free(profile_list, 0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    sdp_record_free(record);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> session;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="deauth_8c.html#a553b17e971c2c61a16fe54dbbb5dde54">  216</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#a553b17e971c2c61a16fe54dbbb5dde54">init_server</a>(<span class="keyword">struct</span> sockaddr_rc *loc_addr, sdp_session_t **session) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// allocate socket</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">int</span> s = socket(AF_BLUETOOTH, SOCK_STREAM, BTPROTO_RFCOMM);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> port = 1;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// local bluetooth adapter</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    loc_addr-&gt;rc_family = AF_BLUETOOTH;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    loc_addr-&gt;rc_bdaddr = *BDADDR_ANY;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    loc_addr-&gt;rc_channel = (uint8_t) 1;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// bind socket to port 1 of the first available </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    bind(s, (<span class="keyword">struct</span> sockaddr *)loc_addr, <span class="keyword">sizeof</span>(*loc_addr));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">//register service added</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    *session = <a class="code" href="deauth_8c.html#adffaffff2cd1eea35d6ccd6a91976c5b">register_service</a>(port);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// put socket into listening mode</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    listen(s, port);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">return</span> s;   </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">  243</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a>(<span class="keyword">struct</span> <a class="code" href="structdbus__obj.html">dbus_obj</a> *data_obj) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    system(<span class="stringliteral">&quot;dbus-send --type=method_call --dest=org.gnome.ScreenSaver /org/gnome/ScreenSaver org.gnome.ScreenSaver.Lock&quot;</span>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (data_obj) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="proxy__dbus_8c.html#ac8031b75ad309b625b5ff96c84bfcf94">terminate</a>(data_obj);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        exit(0);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="deauth_8c.html#a8393a3b320bbc9a992ebeea6807583b0">  258</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#a8393a3b320bbc9a992ebeea6807583b0">check_arg</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (argc &lt;= 1) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;usage: %s bt_addr\n&quot;</span>, argv[0]);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="pam__bt__misc_8c.html#a5adb083cc4c3abc2e2f8eb30c6b9adab">verify_bt_addr</a>(argv[1], NULL)) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;%s: %s is not a valid bluetooth address\n&quot;</span>, argv[0], argv[1]);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="deauth_8c.html#aabedf75506971e618c72cf59465b7e71">  277</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#aabedf75506971e618c72cf59465b7e71">is_trusted_client</a>(<span class="keywordtype">char</span> *bt_addr, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="pam__bt__misc_8c.html#a9e3b53d04a57f137adbc8fc09bacae19">trusted_dir_path</a>) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">int</span> num_of_paired, num_of_devices;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordtype">char</span> *username = getlogin();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">char</span> **paired_devices = <a class="code" href="pam__bt__pair_8c.html#a0982f353fa0e015e06eaba9d7164d55d">get_paired_devices</a>(&amp;num_of_paired);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">char</span> **trusted_devices;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> (!(trusted_devices = <a class="code" href="pam__bt__trust_8c.html#a218ab45da59bbecedbd1d6ce4f08cf6e">find_trusted_devices</a>(NULL, <a class="code" href="pam__bt__misc_8c.html#a9e3b53d04a57f137adbc8fc09bacae19">trusted_dir_path</a>, username, &amp;num_of_devices))) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">goto</span> is_trusted_terminate;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//check if device is paired</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="pam__bt__misc_8c.html#ab1dcac140f23316278bc07c80ba6f98b">is_dev_trusted</a>(NULL, bt_addr, paired_devices, num_of_paired))) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">goto</span> is_trusted_terminate;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//check if device is in trusted list</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="pam__bt__misc_8c.html#ab1dcac140f23316278bc07c80ba6f98b">is_dev_trusted</a>(NULL, bt_addr, trusted_devices, num_of_devices)) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">goto</span> is_trusted_terminate;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    status = 1;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;is_trusted_terminate:</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (trusted_devices) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="pam__bt__misc_8c.html#a67e94683bc2c967879c2b18b8b7a7c4b">free_device_list</a>(trusted_devices, num_of_devices);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (paired_devices) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <a class="code" href="pam__bt__misc_8c.html#a67e94683bc2c967879c2b18b8b7a7c4b">free_device_list</a>(paired_devices, num_of_paired);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="deauth_8c.html#a4572da3a2b5e4b3e2f17986d4c2e79d0">  324</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#a4572da3a2b5e4b3e2f17986d4c2e79d0">connect_client</a>(<span class="keywordtype">int</span> s, <span class="keyword">struct</span> sockaddr_rc *rem_addr, socklen_t *opt, <span class="keywordtype">char</span> *authorized_dev, <span class="keyword">struct</span> <a class="code" href="structdbus__obj.html">dbus_obj</a> *data_obj) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// accept one connection</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">int</span> client = accept(s, (<span class="keyword">struct</span> sockaddr *)rem_addr, opt);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    fcntl(client, F_SETFL, O_NONBLOCK); <span class="comment">//set FD to nonblocking </span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//bdaddr_t stores information about the bluetooth device address.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    ba2str(&amp;(rem_addr-&gt;rc_bdaddr), buf); <span class="comment">//converts the bluetooth data structure to string</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;accepted connection from %s\n&quot;</span>, buf);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="deauth_8c.html#aabedf75506971e618c72cf59465b7e71">is_trusted_client</a>(buf, <a class="code" href="pam__bt__misc_8c.html#a9e3b53d04a57f137adbc8fc09bacae19">trusted_dir_path</a>) || strcmp(buf, authorized_dev) != 0) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        printf(<span class="stringliteral">&quot;%s is not trusted or not authorized to deauthenticate the system\n&quot;</span>, buf);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a>(data_obj);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">return</span> client;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="deauth_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">  343</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="deauth_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">struct </span>sockaddr_rc loc_addr = { 0 }, rem_addr = { 0 };</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">int</span> server = -1, client = -1, bytes_read, num_bytes_read = 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    socklen_t opt = <span class="keyword">sizeof</span>(rem_addr);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    sdp_session_t *session = NULL; <span class="comment">//SDP socket</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="deauth_8c.html#a8393a3b320bbc9a992ebeea6807583b0">check_arg</a>(argc, argv)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a>(NULL);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">//check if the device passed is trusted</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="deauth_8c.html#aabedf75506971e618c72cf59465b7e71">is_trusted_client</a>(argv[1], <a class="code" href="pam__bt__misc_8c.html#a9e3b53d04a57f137adbc8fc09bacae19">trusted_dir_path</a>)) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a>(NULL);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    server = <a class="code" href="deauth_8c.html#a553b17e971c2c61a16fe54dbbb5dde54">init_server</a>(&amp;loc_addr, &amp;session);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">struct </span><a class="code" href="structserver__data__t.html">server_data_t</a> server_data = {<a class="code" href="structserver__data__t.html#a4f1330a6fc19193d6cc53230ecf536f2">server</a>, &amp;<a class="code" href="structserver__data__t.html#a1f5ebfa6bad8c723fedcda1fa39f47e7">client</a>, <a class="code" href="structserver__data__t.html#a1a39afa8e60759b4918ac92ff3d9c5f7">session</a>};</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    time_t start, stop;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">struct </span><a class="code" href="structdbus__obj.html">dbus_obj</a> *data_obj = <a class="code" href="proxy__dbus_8c.html#a88ce9314425e4cdfa4b0ece59ecf2fcb">set_lock_listener</a>(&amp;server_data);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (!data_obj) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="deauth_8c.html#a3000869e3fe498f41505e97cccdbd904">terminate_server</a>(server_data.<a class="code" href="structserver__data__t.html#a4f1330a6fc19193d6cc53230ecf536f2">server</a>, *(server_data.<a class="code" href="structserver__data__t.html#a1f5ebfa6bad8c723fedcda1fa39f47e7">client</a>), server_data.<a class="code" href="structserver__data__t.html#a1a39afa8e60759b4918ac92ff3d9c5f7">session</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">while</span>(1) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">client</a> &lt; 0) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <a class="code" href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">client</a> = <a class="code" href="deauth_8c.html#a4572da3a2b5e4b3e2f17986d4c2e79d0">connect_client</a>(<a class="code" href="structdbus__obj.html#a51d73a8debccbbf2101a81ea723af8ee">server</a>, &amp;rem_addr, &amp;opt, argv[1], data_obj);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            start = time(NULL);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            stop = start;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        memset(buf, 0, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// read data from the client</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        bytes_read = read(<a class="code" href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">client</a>, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">if</span>(bytes_read &gt; 0 &amp;&amp; num_bytes_read &lt; INT_MAX){ <span class="comment">//read something, lets append some data to the msg array</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            num_bytes_read += bytes_read; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">//when 5 seconds have passsed check throughput in bytes, and see if meeting expected minThroughput</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> ((stop-start) &gt; 5){</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordtype">double</span> throughput = num_bytes_read/(stop-start); </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            num_bytes_read = 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            start = time(NULL);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">if</span> (throughput &lt; <a class="code" href="deauth_8c.html#a7c3ba1c119b90f8c6cc5231b3f95c726">minThroughput</a>){</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                printf(<span class="stringliteral">&quot;Failed minimum throughput of %d. Received: %f\n&quot;</span>, <a class="code" href="deauth_8c.html#a7c3ba1c119b90f8c6cc5231b3f95c726">minThroughput</a>, throughput);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <a class="code" href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a>(data_obj);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        stop = time(NULL);  </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span> (bytes_read &gt; 0 &amp;&amp; write(<a class="code" href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">client</a>, buf, strlen(buf) &lt; 0)) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            perror(<span class="stringliteral">&quot;Error writing to client&quot;</span>);  </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordtype">char</span> *msg = <span class="stringliteral">&quot;hello&quot;</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        write(<a class="code" href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">client</a>, msg, strlen(msg));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="proxy__dbus_8c.html#a9ae980c82d5ae70684b4e6d2b8110c27">check_lock_status</a>(data_obj-&gt;<a class="code" href="structdbus__obj.html#affc83ea88688889e796704afad0436eb">context</a>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">//should never come here unless the program is killed or the loop breaks</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="proxy__dbus_8c.html#ac8031b75ad309b625b5ff96c84bfcf94">terminate</a>(data_obj);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="ttc" id="adeauth_8c_html_a0f347b60daa600951edcb110491a98bb"><div class="ttname"><a href="deauth_8c.html#a0f347b60daa600951edcb110491a98bb">sdp_connect</a></div><div class="ttdeci">sdp_session_t * sdp_connect(const bdaddr_t *src, const bdaddr_t *dst, uint32_t flags)</div></div>
<div class="ttc" id="adeauth_8c_html_a100a7b8b4efd0ca70223a63e5cc92857"><div class="ttname"><a href="deauth_8c.html#a100a7b8b4efd0ca70223a63e5cc92857">set_l2cap_info</a></div><div class="ttdeci">void set_l2cap_info(sdp_list_t **l2cap_list, sdp_list_t **proto_list, uuid_t *l2cap_uuid)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00106">deauth.c:106</a></div></div>
<div class="ttc" id="adeauth_8c_html_a1620ed5f9a7602c963e384192621b12a"><div class="ttname"><a href="deauth_8c.html#a1620ed5f9a7602c963e384192621b12a">lock</a></div><div class="ttdeci">void lock(struct dbus_obj *data_obj)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00243">deauth.c:243</a></div></div>
<div class="ttc" id="adeauth_8c_html_a24ba7041aeadc36e8ebc312f087b7e5a"><div class="ttname"><a href="deauth_8c.html#a24ba7041aeadc36e8ebc312f087b7e5a">SERVICE_PROV</a></div><div class="ttdeci">#define SERVICE_PROV</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00028">deauth.c:28</a></div></div>
<div class="ttc" id="adeauth_8c_html_a3000869e3fe498f41505e97cccdbd904"><div class="ttname"><a href="deauth_8c.html#a3000869e3fe498f41505e97cccdbd904">terminate_server</a></div><div class="ttdeci">void terminate_server(int server, int client, sdp_session_t *session)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00044">deauth.c:44</a></div></div>
<div class="ttc" id="adeauth_8c_html_a302042408ed9bc8cafe612e5352f3646"><div class="ttname"><a href="deauth_8c.html#a302042408ed9bc8cafe612e5352f3646">SERVICE_DESC</a></div><div class="ttdeci">#define SERVICE_DESC</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00027">deauth.c:27</a></div></div>
<div class="ttc" id="adeauth_8c_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="deauth_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00343">deauth.c:343</a></div></div>
<div class="ttc" id="adeauth_8c_html_a44fd87ff5d7e23f995e2af34b13f22e8"><div class="ttname"><a href="deauth_8c.html#a44fd87ff5d7e23f995e2af34b13f22e8">set_browsable</a></div><div class="ttdeci">void set_browsable(sdp_list_t **root_list, sdp_record_t *record, uuid_t *root_uuid)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00097">deauth.c:97</a></div></div>
<div class="ttc" id="adeauth_8c_html_a4572da3a2b5e4b3e2f17986d4c2e79d0"><div class="ttname"><a href="deauth_8c.html#a4572da3a2b5e4b3e2f17986d4c2e79d0">connect_client</a></div><div class="ttdeci">int connect_client(int s, struct sockaddr_rc *rem_addr, socklen_t *opt, char *authorized_dev, struct dbus_obj *data_obj)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00324">deauth.c:324</a></div></div>
<div class="ttc" id="adeauth_8c_html_a553b17e971c2c61a16fe54dbbb5dde54"><div class="ttname"><a href="deauth_8c.html#a553b17e971c2c61a16fe54dbbb5dde54">init_server</a></div><div class="ttdeci">int init_server(struct sockaddr_rc *loc_addr, sdp_session_t **session)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00216">deauth.c:216</a></div></div>
<div class="ttc" id="adeauth_8c_html_a5ecc06b4fbeedd8edd0692663fb76489"><div class="ttname"><a href="deauth_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a></div><div class="ttdeci">#define SERVICE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00026">deauth.c:26</a></div></div>
<div class="ttc" id="adeauth_8c_html_a614303fa465a6ead9d2192eb5b4f7860"><div class="ttname"><a href="deauth_8c.html#a614303fa465a6ead9d2192eb5b4f7860">set_bluetooth_service_info</a></div><div class="ttdeci">void set_bluetooth_service_info(sdp_profile_desc_t *profile, sdp_list_t **profile_list, sdp_record_t *record)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00086">deauth.c:86</a></div></div>
<div class="ttc" id="adeauth_8c_html_a7c3ba1c119b90f8c6cc5231b3f95c726"><div class="ttname"><a href="deauth_8c.html#a7c3ba1c119b90f8c6cc5231b3f95c726">minThroughput</a></div><div class="ttdeci">#define minThroughput</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00029">deauth.c:29</a></div></div>
<div class="ttc" id="adeauth_8c_html_a822797738ca4ed6abfc03035c50bd356"><div class="ttname"><a href="deauth_8c.html#a822797738ca4ed6abfc03035c50bd356">sdp_close</a></div><div class="ttdeci">int sdp_close(sdp_session_t *session)</div></div>
<div class="ttc" id="adeauth_8c_html_a8393a3b320bbc9a992ebeea6807583b0"><div class="ttname"><a href="deauth_8c.html#a8393a3b320bbc9a992ebeea6807583b0">check_arg</a></div><div class="ttdeci">int check_arg(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00258">deauth.c:258</a></div></div>
<div class="ttc" id="adeauth_8c_html_aabedf75506971e618c72cf59465b7e71"><div class="ttname"><a href="deauth_8c.html#aabedf75506971e618c72cf59465b7e71">is_trusted_client</a></div><div class="ttdeci">int is_trusted_client(char *bt_addr, const char *trusted_dir_path)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00277">deauth.c:277</a></div></div>
<div class="ttc" id="adeauth_8c_html_ab60d5a453b8ddc3dabc609fda5b03da2"><div class="ttname"><a href="deauth_8c.html#ab60d5a453b8ddc3dabc609fda5b03da2">sdp_record_register</a></div><div class="ttdeci">int sdp_record_register(sdp_session_t *sess, sdp_record_t *rec, uint8_t flags)</div></div>
<div class="ttc" id="adeauth_8c_html_ad44ae7f0926e25e6497a022253b7982a"><div class="ttname"><a href="deauth_8c.html#ad44ae7f0926e25e6497a022253b7982a">set_service</a></div><div class="ttdeci">void set_service(uuid_t *svc_uuid, uuid_t *svc_class_uuid, sdp_list_t **svc_class_list, sdp_record_t *record, uint32_t *svc_uuid_int)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00065">deauth.c:65</a></div></div>
<div class="ttc" id="adeauth_8c_html_adffaffff2cd1eea35d6ccd6a91976c5b"><div class="ttname"><a href="deauth_8c.html#adffaffff2cd1eea35d6ccd6a91976c5b">register_service</a></div><div class="ttdeci">sdp_session_t * register_service(uint8_t rfcomm_channel)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00135">deauth.c:135</a></div></div>
<div class="ttc" id="adeauth_8c_html_af5b58ce1d118346d8a948132b950e279"><div class="ttname"><a href="deauth_8c.html#af5b58ce1d118346d8a948132b950e279">register_rfcomm_sock</a></div><div class="ttdeci">void register_rfcomm_sock(sdp_data_t **channel, sdp_record_t *record, sdp_list_t **rfcomm_list, sdp_list_t **proto_list, sdp_list_t **access_proto_list, uuid_t *rfcomm_uuid, uint8_t *rfcomm_channel)</div><div class="ttdef"><b>Definition:</b> <a href="deauth_8c_source.html#l00115">deauth.c:115</a></div></div>
<div class="ttc" id="apam__bt__misc_8c_html_a5adb083cc4c3abc2e2f8eb30c6b9adab"><div class="ttname"><a href="pam__bt__misc_8c.html#a5adb083cc4c3abc2e2f8eb30c6b9adab">verify_bt_addr</a></div><div class="ttdeci">int verify_bt_addr(char *address, FILE *log_fp)</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__misc_8c_source.html#l00005">pam_bt_misc.c:5</a></div></div>
<div class="ttc" id="apam__bt__misc_8c_html_a67e94683bc2c967879c2b18b8b7a7c4b"><div class="ttname"><a href="pam__bt__misc_8c.html#a67e94683bc2c967879c2b18b8b7a7c4b">free_device_list</a></div><div class="ttdeci">void free_device_list(char **device_list, int num_of_devices)</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__misc_8c_source.html#l00055">pam_bt_misc.c:55</a></div></div>
<div class="ttc" id="apam__bt__misc_8c_html_a9e3b53d04a57f137adbc8fc09bacae19"><div class="ttname"><a href="pam__bt__misc_8c.html#a9e3b53d04a57f137adbc8fc09bacae19">trusted_dir_path</a></div><div class="ttdeci">const char * trusted_dir_path</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__misc_8c_source.html#l00003">pam_bt_misc.c:3</a></div></div>
<div class="ttc" id="apam__bt__misc_8c_html_ab1dcac140f23316278bc07c80ba6f98b"><div class="ttname"><a href="pam__bt__misc_8c.html#ab1dcac140f23316278bc07c80ba6f98b">is_dev_trusted</a></div><div class="ttdeci">int is_dev_trusted(FILE *log_fp, char *dev, char **trusted_devices, int num_of_devices)</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__misc_8c_source.html#l00046">pam_bt_misc.c:46</a></div></div>
<div class="ttc" id="apam__bt__misc_8h_html"><div class="ttname"><a href="pam__bt__misc_8h.html">pam_bt_misc.h</a></div></div>
<div class="ttc" id="apam__bt__pair_8c_html_a0982f353fa0e015e06eaba9d7164d55d"><div class="ttname"><a href="pam__bt__pair_8c.html#a0982f353fa0e015e06eaba9d7164d55d">get_paired_devices</a></div><div class="ttdeci">char ** get_paired_devices(int *num_of_paired)</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__pair_8c_source.html#l00086">pam_bt_pair.c:86</a></div></div>
<div class="ttc" id="apam__bt__pair_8h_html"><div class="ttname"><a href="pam__bt__pair_8h.html">pam_bt_pair.h</a></div></div>
<div class="ttc" id="apam__bt__trust_8c_html_a218ab45da59bbecedbd1d6ce4f08cf6e"><div class="ttname"><a href="pam__bt__trust_8c.html#a218ab45da59bbecedbd1d6ce4f08cf6e">find_trusted_devices</a></div><div class="ttdeci">char ** find_trusted_devices(FILE *log_fp, const char *trusted_dir_path, const char *username, int *num_of_devices)</div><div class="ttdef"><b>Definition:</b> <a href="pam__bt__trust_8c_source.html#l00093">pam_bt_trust.c:93</a></div></div>
<div class="ttc" id="apam__bt__trust_8h_html"><div class="ttname"><a href="pam__bt__trust_8h.html">pam_bt_trust.h</a></div></div>
<div class="ttc" id="apam__misc_8h_html"><div class="ttname"><a href="pam__misc_8h.html">pam_misc.h</a></div></div>
<div class="ttc" id="aproxy__dbus_8c_html_a88ce9314425e4cdfa4b0ece59ecf2fcb"><div class="ttname"><a href="proxy__dbus_8c.html#a88ce9314425e4cdfa4b0ece59ecf2fcb">set_lock_listener</a></div><div class="ttdeci">struct dbus_obj * set_lock_listener(struct server_data_t *server)</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8c_source.html#l00038">proxy_dbus.c:38</a></div></div>
<div class="ttc" id="aproxy__dbus_8c_html_a9ae980c82d5ae70684b4e6d2b8110c27"><div class="ttname"><a href="proxy__dbus_8c.html#a9ae980c82d5ae70684b4e6d2b8110c27">check_lock_status</a></div><div class="ttdeci">void check_lock_status(GMainContext *context)</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8c_source.html#l00078">proxy_dbus.c:78</a></div></div>
<div class="ttc" id="aproxy__dbus_8c_html_ac8031b75ad309b625b5ff96c84bfcf94"><div class="ttname"><a href="proxy__dbus_8c.html#ac8031b75ad309b625b5ff96c84bfcf94">terminate</a></div><div class="ttdeci">void terminate(struct dbus_obj *data_obj)</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8c_source.html#l00003">proxy_dbus.c:3</a></div></div>
<div class="ttc" id="aproxy__dbus_8h_html"><div class="ttname"><a href="proxy__dbus_8h.html">proxy_dbus.h</a></div></div>
<div class="ttc" id="astructdbus__obj_html"><div class="ttname"><a href="structdbus__obj.html">dbus_obj</a></div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00020">proxy_dbus.h:20</a></div></div>
<div class="ttc" id="astructdbus__obj_html_a51d73a8debccbbf2101a81ea723af8ee"><div class="ttname"><a href="structdbus__obj.html#a51d73a8debccbbf2101a81ea723af8ee">dbus_obj::server</a></div><div class="ttdeci">int server</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00024">proxy_dbus.h:24</a></div></div>
<div class="ttc" id="astructdbus__obj_html_ad58dbe29730cff122409a8acd2577ba0"><div class="ttname"><a href="structdbus__obj.html#ad58dbe29730cff122409a8acd2577ba0">dbus_obj::client</a></div><div class="ttdeci">int * client</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00025">proxy_dbus.h:25</a></div></div>
<div class="ttc" id="astructdbus__obj_html_affc83ea88688889e796704afad0436eb"><div class="ttname"><a href="structdbus__obj.html#affc83ea88688889e796704afad0436eb">dbus_obj::context</a></div><div class="ttdeci">GMainContext * context</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00021">proxy_dbus.h:21</a></div></div>
<div class="ttc" id="astructserver__data__t_html"><div class="ttname"><a href="structserver__data__t.html">server_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00014">proxy_dbus.h:14</a></div></div>
<div class="ttc" id="astructserver__data__t_html_a1a39afa8e60759b4918ac92ff3d9c5f7"><div class="ttname"><a href="structserver__data__t.html#a1a39afa8e60759b4918ac92ff3d9c5f7">server_data_t::session</a></div><div class="ttdeci">sdp_session_t * session</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00017">proxy_dbus.h:17</a></div></div>
<div class="ttc" id="astructserver__data__t_html_a1f5ebfa6bad8c723fedcda1fa39f47e7"><div class="ttname"><a href="structserver__data__t.html#a1f5ebfa6bad8c723fedcda1fa39f47e7">server_data_t::client</a></div><div class="ttdeci">int * client</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00016">proxy_dbus.h:16</a></div></div>
<div class="ttc" id="astructserver__data__t_html_a4f1330a6fc19193d6cc53230ecf536f2"><div class="ttname"><a href="structserver__data__t.html#a4f1330a6fc19193d6cc53230ecf536f2">server_data_t::server</a></div><div class="ttdeci">int server</div><div class="ttdef"><b>Definition:</b> <a href="proxy__dbus_8h_source.html#l00015">proxy_dbus.h:15</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Jan 15 2022 22:37:44 for ProxyAuth by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
